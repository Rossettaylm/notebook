# 处理器体系结构

> 处理器是如何通过**指令集体系结构**(ISA, Instruction-Set Architecture)来执行指令的？
>
> 现代处理器通过同时执行多条指令的不同部分，处理器可以获得更高的性能。

## 一、简单Y86-64指令系统

处理器的可访问部分：

- RF: 16个寄存器，包括一个%rsp来指向栈顶指针
- CC: 条件码，保存最近的算术或逻辑运算所造成的影响的相关信息
- PC: 程序计数器，存放当前正在执行指令的地址

---------

- DMEM: 内存，很大的字节数组，保存着数据和程序，通过虚拟地址来引用内存位置，通过硬件和操作系统来将虚拟地址翻译成物理地址，指明数据的实际位置

- Stat: 程序状态表明了程序的执行的总体状态，如读取了非法的内存地址，通常包括了异常处理

  --------------

一条完整的指令包括1字节**指令指示符**、1字节**寄存器指示符**、还可能包含一个8字节的常数字。

![image-20220411135817586](https://rossetta-typora-imgsubmit.oss-cn-hangzhou.aliyuncs.com/img/image-20220411135817586.png)

![image-20220411134825132](https://rossetta-typora-imgsubmit.oss-cn-hangzhou.aliyuncs.com/img/image-20220411134825132.png)

1. 上图为**指令指示符**，占一个字节，代码部分+功能部分每部分4位，如上图，jmp的功能部分低4位为0代表无条件跳转

2. 每个寄存器都有其相对应的**寄存器标识符（register ID）**，范围为0x0 ~ 0xE，CPU中有一个寄存器文件，是寄存器ID为地址的随机访问存储器，且0xF表示无寄存器。指令都是一串二进制代码，如果没有寄存器操作数的指令，如call，就没有寄存器指示符字节；如果只有一个寄存器操作数的指令，如pushq，就将另一个寄存器指示符设为0xF。

3. **常数字**可以作为指令的立即数数据，也可以作为指令的地址偏移量，可以编码成1、2、4、8个字节。

---------

## 二、逻辑设计和HCL（硬件控制语言）

> 组成一个数字系统的三个部分：
>
> - 计算对位进行操作的函数的 **组合逻辑**
> - 存储位的**存储器单元**
> - 控制存储器单元更新的**时钟信号**

